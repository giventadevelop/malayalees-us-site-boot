# PostgreSQL Configuration for Caching Optimization
# This file is mounted into the PostgreSQL container for optimal performance

# =============================================
# MEMORY CONFIGURATION FOR CACHING
# =============================================

# Shared Buffers - 25% of total memory (adjust based on your system)
shared_buffers = 256MB

# Effective Cache Size - 75% of total memory (adjust based on your system)
effective_cache_size = 768MB

# Work Memory for complex queries
work_mem = 16MB

# Maintenance Work Memory
maintenance_work_mem = 128MB

# =============================================
# CONNECTION SETTINGS
# =============================================

# Maximum number of concurrent connections
max_connections = 100

# Enable query statistics for monitoring
shared_preload_libraries = 'pg_stat_statements'

# =============================================
# LOGGING FOR DEVELOPMENT
# =============================================

# Log all statements (useful for development)
log_statement = 'all'

# Log slow queries (queries taking more than 1 second)
log_min_duration_statement = 1000

# Log line prefix for better debugging
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '

# =============================================
# PERFORMANCE SETTINGS
# =============================================

# Random page cost (optimized for SSD)
random_page_cost = 1.1

# Effective I/O concurrency
effective_io_concurrency = 200

# =============================================
# CACHING OPTIMIZATIONS
# =============================================

# Enable query result caching
enable_hashjoin = on
enable_mergejoin = on
enable_nestloop = on

# Optimize for caching
default_statistics_target = 100

# =============================================
# SECURITY SETTINGS (Development Only)
# =============================================

# Allow connections from any IP (development only)
listen_addresses = '*'

# Enable SSL (optional for development)
# ssl = off








